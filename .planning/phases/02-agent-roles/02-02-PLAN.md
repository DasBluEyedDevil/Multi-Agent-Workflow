---
phase: 02-agent-roles
plan: 02
type: execute
wave: 2
depends_on: []
files_modified:
  - .kimi/agents/debugger.yaml
  - .kimi/agents/debugger.md
  - .kimi/agents/refactorer.yaml
  - .kimi/agents/refactorer.md
  - .kimi/agents/implementer.yaml
  - .kimi/agents/implementer.md
  - .kimi/agents/simplifier.yaml
  - .kimi/agents/simplifier.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Action role agent files exist and are syntactically valid YAML"
    - "Action roles have full tool access (no exclude_tools)"
    - "All action roles use structured output format"
    - "Debugger includes audit trail in output"
  artifacts:
    - path: ".kimi/agents/debugger.yaml"
      provides: "Debugger agent configuration with full tool access"
      contains: ["version: 1", "extend: default"]
      excludes: ["exclude_tools"]
    - path: ".kimi/agents/debugger.md"
      provides: "Debugger system prompt with structured output and audit trail"
      contains: ["## SUMMARY", "## FILES", "## ANALYSIS", "## RECOMMENDATIONS", "Commands executed"]
    - path: ".kimi/agents/refactorer.yaml"
      provides: "Refactorer agent configuration with full tool access"
      contains: ["version: 1", "extend: default"]
      excludes: ["exclude_tools"]
    - path: ".kimi/agents/refactorer.md"
      provides: "Refactorer system prompt with structured output"
      contains: ["## SUMMARY", "## FILES", "## ANALYSIS", "## RECOMMENDATIONS"]
    - path: ".kimi/agents/implementer.yaml"
      provides: "Implementer agent configuration with full tool access"
      contains: ["version: 1", "extend: default"]
      excludes: ["exclude_tools"]
    - path: ".kimi/agents/implementer.md"
      provides: "Implementer system prompt with structured output"
      contains: ["## SUMMARY", "## FILES", "## ANALYSIS", "## RECOMMENDATIONS"]
    - path: ".kimi/agents/simplifier.yaml"
      provides: "Simplifier agent configuration with full tool access"
      contains: ["version: 1", "extend: default"]
      excludes: ["exclude_tools"]
    - path: ".kimi/agents/simplifier.md"
      provides: "Simplifier system prompt with structured output"
      contains: ["## SUMMARY", "## FILES", "## ANALYSIS", "## RECOMMENDATIONS"]
  key_links:
    - from: "*.yaml"
      to: "*.md"
      via: "system_prompt_path field"
      pattern: "system_prompt_path:.*\\.md"
---

<objective>
Create 4 action role agent configurations (debugger, refactorer, implementer, simplifier) with YAML files and system prompt markdown files. Action roles have full tool access for autonomous work.

Purpose: Enable users to delegate autonomous coding tasks (debugging, refactoring, implementation, simplification) to Kimi agents that can read, write, and execute.
Output: 4 agent YAML files and 4 system prompt markdown files in .kimi/agents/
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/02-agent-roles/02-CONTEXT.md
@.planning/phases/02-agent-roles/02-RESEARCH.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create debugger agent</name>
  <files>
    .kimi/agents/debugger.yaml
    .kimi/agents/debugger.md
  </files>
  <action>
    Create .kimi/agents/debugger.yaml:
    - version: 1
    - agent.extend: default
    - agent.name: debugger
    - agent.system_prompt_path: ./debugger.md
    - NO exclude_tools (full access)
    
    Create .kimi/agents/debugger.md with sections:
    1. **Identity**: "You are the Debugger agent, a systematic bug investigation specialist."
    2. **Objective**: Investigate bugs, trace execution paths, and apply fixes
    3. **Process** (structured phases):
       - **Trace**: Identify entry points and follow code flow
       - **Reproduce**: Create minimal reproduction if possible
       - **Hypothesize**: Form theories about root cause
       - **Verify**: Test hypotheses and confirm fix
       - Document all shell commands executed in ANALYSIS section
    4. **Audit Trail Requirement**: MUST include "Commands executed: " section in ANALYSIS with all shell commands run
    5. **Output Format** (MUST use exact structure):
       ```
       ## SUMMARY
       [brief overview of bug and fix]
       
       ## FILES
       [files analyzed and modified]
       
       ## ANALYSIS
       [investigation details including "Commands executed: [list]"]
       
       ## RECOMMENDATIONS
       [follow-up actions or prevention]
       ```
    6. **Constraints**: You are a subagent reporting back to Claude. Log all commands.
    
    Use ${KIMI_WORK_DIR} and ${KIMI_NOW} variables.
  </action>
  <verify>
    Test YAML syntax and verify markdown has all required sections including "Commands executed" instruction
  </verify>
  <done>
    debugger.yaml exists with version: 1, extend: default, no exclude_tools
    debugger.md has complete prompt with systematic debugging phases and audit trail requirement
  </done>
</task>

<task type="auto">
  <name>Task 2: Create refactorer agent</name>
  <files>
    .kimi/agents/refactorer.yaml
    .kimi/agents/refactorer.md
  </files>
  <action>
    Create .kimi/agents/refactorer.yaml with name: refactorer, system_prompt_path: ./refactorer.md, no exclude_tools.
    
    Create .kimi/agents/refactorer.md with sections:
    1. **Identity**: "You are the Refactorer agent, a code restructuring specialist."
    2. **Objective**: Restructure code while preserving behavior, improve patterns
    3. **Process**:
       - Read and understand existing code thoroughly
       - Identify refactoring targets (duplication, complexity, poor naming)
       - Apply refactorings incrementally (extract method, rename, reorganize)
       - Verify behavior preservation through analysis or tests
       - Maintain consistency with existing patterns unless clearly inferior
    4. **Output Format** (same exact structure as debugger):
    5. **Constraints**: You are a subagent reporting back to Claude. Preserve behavior.
  </action>
  <verify>
    Test YAML syntax and verify markdown has all required sections
  </verify>
  <done>
    refactorer.yaml exists with full access, refactorer.md has complete prompt
  </done>
</task>

<task type="auto">
  <name>Task 3: Create implementer agent</name>
  <files>
    .kimi/agents/implementer.yaml
    .kimi/agents/implementer.md
  </files>
  <action>
    Create .kimi/agents/implementer.yaml with name: implementer, system_prompt_path: ./implementer.md, no exclude_tools.
    
    Create .kimi/agents/implementer.md with sections:
    1. **Identity**: "You are the Implementer agent, a feature implementation specialist."
    2. **Objective**: Build new features from specifications with freedom to choose optimal approach
    3. **Process**:
       - Understand requirements and existing codebase
       - Design implementation (not constrained to match existing patterns if inferior)
       - Write clean, well-documented code
       - Add tests where appropriate
       - Verify implementation meets requirements
    4. **Greenfield Freedom**: "You may introduce new patterns when justified, regardless of existing conventions."
    5. **Output Format** (same exact structure):
    6. **Constraints**: You are a subagent reporting back to Claude.
  </action>
  <verify>
    Test YAML syntax and verify markdown has all required sections including greenfield freedom statement
  </verify>
  <done>
    implementer.yaml exists with full access, implementer.md has complete prompt with greenfield freedom
  </done>
</task>

<task type="auto">
  <name>Task 4: Create simplifier agent</name>
  <files>
    .kimi/agents/simplifier.yaml
    .kimi/agents/simplifier.md
  </files>
  <action>
    Create .kimi/agents/simplifier.yaml with name: simplifier, system_prompt_path: ./simplifier.md, no exclude_tools.
    
    Create .kimi/agents/simplifier.md with sections:
    1. **Identity**: "You are the Simplifier agent, a complexity reduction specialist."
    2. **Objective**: Reduce complexity, remove dead code, consolidate abstractions
    3. **Process**:
       - Analyze codebase for complexity hotspots
       - Identify dead code, unused imports, unnecessary abstractions
       - Simplify without losing functionality
       - Consolidate duplicate logic
       - Verify no functionality is lost
    4. **Output Format** (same exact structure):
    5. **Constraints**: You are a subagent reporting back to Claude.
  </action>
  <verify>
    Test YAML syntax and verify markdown has all required sections
  </verify>
  <done>
    simplifier.yaml exists with full access, simplifier.md has complete prompt
  </done>
</task>

</tasks>

<verification>
- All 8 files exist in .kimi/agents/
- All YAML files pass syntax validation
- All YAML files have NO exclude_tools (full access)
- All markdown files have SUMMARY/FILES/ANALYSIS/RECOMMENDATIONS sections
- Debugger prompt explicitly requires "Commands executed" audit trail
- Implementer prompt includes greenfield freedom statement
- All prompts use ${KIMI_WORK_DIR} and ${KIMI_NOW}
- All prompts include "subagent reporting back to Claude"
</verification>

<success_criteria>
- 4 action role YAML files created with full tool access (no exclusions)
- 4 system prompt markdown files created with structured output
- Debugger has unique audit trail requirement
- Implementer has greenfield freedom statement
- All files follow the research-specified patterns
</success_criteria>

<output>
After completion, create `.planning/phases/02-agent-roles/02-02-SUMMARY.md`
</output>
