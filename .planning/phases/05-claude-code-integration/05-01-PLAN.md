---
phase: 05-claude-code-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/commands/kimi/kimi-analyze.md
  - .claude/commands/kimi/kimi-audit.md
  - .claude/commands/kimi/kimi-trace.md
  - .claude/commands/kimi/kimi-verify.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can type /kimi-analyze in Claude Code and Kimi is invoked with reviewer role"
    - "User can type /kimi-audit in Claude Code and Kimi is invoked with auditor role"
    - "User can type /kimi-trace in Claude Code and Kimi is invoked with debugger role"
    - "User can type /kimi-verify in Claude Code and Kimi is invoked with verify template"
  artifacts:
    - path: ".claude/commands/kimi/kimi-analyze.md"
      provides: "Slash command for code analysis delegation"
      min_lines: 30
    - path: ".claude/commands/kimi/kimi-audit.md"
      provides: "Slash command for code audit delegation"
      min_lines: 30
    - path: ".claude/commands/kimi/kimi-trace.md"
      provides: "Slash command for bug tracing delegation"
      min_lines: 30
    - path: ".claude/commands/kimi/kimi-verify.md"
      provides: "Slash command for post-change verification"
      min_lines: 30
  key_links:
    - from: ".claude/commands/kimi/*.md"
      to: "skills/kimi.agent.wrapper.sh"
      via: "bash invocation in command instructions"
      pattern: "kimi\\.agent\\.wrapper\\.sh"
---

<objective>
Create 4 Claude Code slash commands that delegate work to Kimi CLI via the wrapper script.

Purpose: Enable Claude Code users to invoke Kimi with a single slash command for common research and verification tasks.
Output: 4 slash command files in `.claude/commands/kimi/` directory that Claude can execute via bash.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@skills/kimi.agent.wrapper.sh
@.claude/commands/gemini/gemini-analyze.md
@.claude/commands/gemini/gemini-verify.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /kimi-analyze and /kimi-audit commands</name>
  <files>
    .claude/commands/kimi/kimi-analyze.md
    .claude/commands/kimi/kimi-audit.md
  </files>
  <action>
Create the `.claude/commands/kimi/` directory if it doesn't exist.

Create `kimi-analyze.md` slash command:
- Title: "Kimi Analyze"
- Purpose: Delegate codebase analysis to Kimi's K2.5 large context window
- Usage: `/kimi-analyze [directory] [question]`
- Maps to: `skills/kimi.agent.wrapper.sh -r reviewer -d "@dir/" "question"`
- Include example invocations showing directory and question parameters
- Include "When to Use" section (understanding architecture, finding patterns, pre-implementation research)
- Include response format (SUMMARY/FILES/ANALYSIS/RECOMMENDATIONS)
- Include "Instructions for Claude" section telling Claude to run the wrapper via bash

Create `kimi-audit.md` slash command:
- Title: "Kimi Audit"
- Purpose: Delegate code quality and architecture audit to Kimi
- Usage: `/kimi-audit [directory] [focus area]`
- Maps to: `skills/kimi.agent.wrapper.sh -r auditor -d "@dir/" "focus area"`
- Include example invocations for quality audit, architecture conformance, best practices
- Include "When to Use" section (code quality checks, architecture review, compliance audits)
- Include response format and Instructions for Claude

Follow the structure of existing gemini commands but adapt for kimi wrapper:
- Use bash invocation (not PowerShell) since kimi wrapper is bash-native
- Include the -w flag for working directory if user specifies a path
- Explain that --thinking can be added for deeper analysis
  </action>
  <verify>
Files exist and contain:
- `cat .claude/commands/kimi/kimi-analyze.md` shows reviewer role, bash invocation
- `cat .claude/commands/kimi/kimi-audit.md` shows auditor role, bash invocation
- Both files have >30 lines
  </verify>
  <done>
/kimi-analyze command invokes wrapper with -r reviewer
/kimi-audit command invokes wrapper with -r auditor
Both include usage, examples, when to use, response format, and Claude instructions
  </done>
</task>

<task type="auto">
  <name>Task 2: Create /kimi-trace and /kimi-verify commands</name>
  <files>
    .claude/commands/kimi/kimi-trace.md
    .claude/commands/kimi/kimi-verify.md
  </files>
  <action>
Create `kimi-trace.md` slash command:
- Title: "Kimi Trace"
- Purpose: Delegate bug tracing and debugging investigation to Kimi
- Usage: `/kimi-trace [description of bug or behavior]`
- Maps to: `skills/kimi.agent.wrapper.sh -r debugger "bug description"`
- Include example invocations for tracing execution paths, finding root causes, understanding error flows
- Include "When to Use" section (mysterious bugs, tracing across files, understanding error propagation)
- Note: debugger role has FULL tool access -- it can read, write, and execute to investigate
- Include response format and Instructions for Claude

Create `kimi-verify.md` slash command:
- Title: "Kimi Verify"
- Purpose: Verify implementation changes for consistency and regressions
- Usage: `/kimi-verify [description of changes]`
- Maps to: `skills/kimi.agent.wrapper.sh -t verify --diff "change description"`
- Key: Uses -t verify (template) AND --diff flag to include git changes
- Include example invocations for post-implementation verification, pre-commit checks
- Include "When to Use" section (after implementing, before committing, after refactoring)
- Include response format and Instructions for Claude

Important for verify command:
- Always include --diff flag to capture recent changes
- Template mode (-t verify) prepends verification instructions
- Can combine with -r security for security-focused verification
  </action>
  <verify>
Files exist and contain:
- `cat .claude/commands/kimi/kimi-trace.md` shows debugger role
- `cat .claude/commands/kimi/kimi-verify.md` shows -t verify and --diff flag
- Both files have >30 lines
  </verify>
  <done>
/kimi-trace command invokes wrapper with -r debugger
/kimi-verify command invokes wrapper with -t verify --diff
Both include usage, examples, when to use, response format, and Claude instructions
  </done>
</task>

</tasks>

<verification>
All 4 slash command files exist in .claude/commands/kimi/:
```bash
ls -la .claude/commands/kimi/
# Should show: kimi-analyze.md, kimi-audit.md, kimi-trace.md, kimi-verify.md
```

Each command contains proper wrapper invocation:
```bash
grep -l "kimi.agent.wrapper.sh" .claude/commands/kimi/*.md | wc -l
# Should return 4
```

Commands use correct roles/templates:
```bash
grep -E "(-r reviewer|-r auditor|-r debugger|-t verify)" .claude/commands/kimi/*.md
```
</verification>

<success_criteria>
- 4 slash command files created in .claude/commands/kimi/
- /kimi-analyze maps to -r reviewer
- /kimi-audit maps to -r auditor
- /kimi-trace maps to -r debugger
- /kimi-verify maps to -t verify --diff
- All commands include bash invocation examples
- All commands include "Instructions for Claude" section
- Requirements INTG-01, INTG-02, INTG-03, INTG-04 satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/05-claude-code-integration/05-01-SUMMARY.md`
</output>
